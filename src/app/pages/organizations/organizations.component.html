<div class="organizations-container">
  <div class="header">
    <h1>Organization Details</h1>
  </div>

  <!-- Loading State -->
  <div class="loading" *ngIf="isLoading">
    <div class="spinner"></div>
    <p>Loading...</p>
  </div>

  <!-- Error Message -->
  <div class="alert alert-error" *ngIf="error">
    <span class="icon">⚠️</span>
    {{ error }}
    <button class="close-btn" (click)="error = null">×</button>
  </div>

  <!-- Success Message -->
  <div class="alert alert-success" *ngIf="successMessage">
    <span class="icon">✓</span>
    {{ successMessage }}
    <button class="close-btn" (click)="successMessage = null">×</button>
  </div>

  <!-- Create Organization Form -->
  <div class="form-container" *ngIf="showCreateForm">
    <h2>Create New Organization</h2>
    <form (ngSubmit)="createOrganization()">
      <div class="form-group">
        <label for="name">Organization Name *</label>
        <input
          type="text"
          id="name"
          [(ngModel)]="newOrganization.name"
          name="name"
          required
          placeholder="Enter organization name"
        />
      </div>

      <div class="form-group">
        <label for="industry">Industry</label>
        <input
          type="text"
          id="industry"
          [(ngModel)]="newOrganization.industry"
          name="industry"
          placeholder="e.g., Technology, Finance, Healthcare"
        />
      </div>

      <div class="form-group">
        <label for="gstNumber">GST Number</label>
        <input
          type="text"
          id="gstNumber"
          [(ngModel)]="newOrganization.gstNumber"
          name="gstNumber"
          placeholder="Enter GST number"
        />
      </div>

      <div class="form-group">
        <label for="country">Country</label>
        <input
          type="text"
          id="country"
          [(ngModel)]="newOrganization.country"
          name="country"
          placeholder="Enter country"
        />
      </div>

      <div class="form-group">
        <label for="plan">Plan</label>
        <select id="plan" [(ngModel)]="newOrganization.plan" name="plan">
          <option value="">Select a plan</option>
          <option value="Free">Free</option>
          <option value="Basic">Basic</option>
          <option value="Pro">Pro</option>
          <option value="Enterprise">Enterprise</option>
        </select>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn btn-primary" [disabled]="isLoading">
          {{ isLoading ? "Creating..." : "Create Organization" }}
        </button>
        <button
          type="button"
          class="btn btn-secondary"
          (click)="cancelForm()"
          [disabled]="isLoading"
        >
          Cancel
        </button>
      </div>
    </form>
  </div>

  <!-- Edit Organization Form -->
  <div class="form-container" *ngIf="showEditForm && selectedOrganization">
    <h2>Edit Organization</h2>
    <form (ngSubmit)="updateOrganization()">
      <div class="form-group">
        <label for="editName">Organization Name *</label>
        <input
          type="text"
          id="editName"
          [(ngModel)]="editOrganization.name"
          name="editName"
          required
          placeholder="Enter organization name"
        />
      </div>

      <div class="form-group">
        <label for="editIndustry">Industry</label>
        <input
          type="text"
          id="editIndustry"
          [(ngModel)]="editOrganization.industry"
          name="editIndustry"
          placeholder="e.g., Technology, Finance, Healthcare"
        />
      </div>

      <div class="form-group">
        <label for="editGstNumber">GST Number</label>
        <input
          type="text"
          id="editGstNumber"
          [(ngModel)]="editOrganization.gstNumber"
          name="editGstNumber"
          placeholder="Enter GST number"
        />
      </div>

      <div class="form-group">
        <label for="editCountry">Country</label>
        <input
          type="text"
          id="editCountry"
          [(ngModel)]="editOrganization.country"
          name="editCountry"
          placeholder="Enter country"
        />
      </div>

      <div class="form-group">
        <label for="editPlan">Plan</label>
        <select
          id="editPlan"
          [(ngModel)]="editOrganization.plan"
          name="editPlan"
        >
          <option value="">Select a plan</option>
          <option value="Free">Free</option>
          <option value="Basic">Basic</option>
          <option value="Pro">Pro</option>
          <option value="Enterprise">Enterprise</option>
        </select>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn btn-primary" [disabled]="isLoading">
          {{ isLoading ? "Updating..." : "Update Organization" }}
        </button>
        <button
          type="button"
          class="btn btn-secondary"
          (click)="cancelForm()"
          [disabled]="isLoading"
        >
          Cancel
        </button>
      </div>
    </form>
  </div>

  <!-- Organization Details -->
  <div class="organization-details" *ngIf="!showCreateForm && !showEditForm && !isLoading && organizations.length > 0">
    <div class="details-card">
      <div class="card-header">
        <h2>{{ organizations[0].name }}</h2>
        <button
          class="btn btn-warning"
          (click)="openEditForm(organizations[0])"
          [disabled]="isLoading"
        >
          ✏️ Edit
        </button>
      </div>
      <div class="card-body">
        <div class="detail-row">
          <span class="label">ID:</span>
          <span class="value">{{ organizations[0].id }}</span>
        </div>
        <div class="detail-row">
          <span class="label">Name:</span>
          <span class="value">{{ organizations[0].name }}</span>
        </div>
        <div class="detail-row">
          <span class="label">Industry:</span>
          <span class="value">{{ organizations[0].industry || "N/A" }}</span>
        </div>
        <div class="detail-row">
          <span class="label">Country:</span>
          <span class="value">{{ organizations[0].country || "N/A" }}</span>
        </div>
        <div class="detail-row">
          <span class="label">GST Number:</span>
          <span class="value">{{ organizations[0].gstNumber || "N/A" }}</span>
        </div>
        <div class="detail-row">
          <span class="label">Plan:</span>
          <span class="value">{{ organizations[0].plan || "N/A" }}</span>
        </div>
        <div class="detail-row" *ngIf="organizations[0].createdAt">
          <span class="label">Created At:</span>
          <span class="value">{{ organizations[0].createdAt | date:'medium' }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- No Organization Message -->
  <div class="no-data" *ngIf="!showCreateForm && !showEditForm && !isLoading && organizations.length === 0 && !error">
    <p>No organization found for your account.</p>
  </div>


</div>
